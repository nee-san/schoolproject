# Description: The Hardened Linux kernel (LTS)
# URL:         https://github.com/anthraxx/linux-hardened
# Maintainer:  MrSenshi, MrSenshi at disroot dot org
# Depends on:  kmod bc libelf xz libressl

name=linux-hardened
version=4.19-lts
reiserfs4patchver=4.18.0
release=2
source=("https://github.com/anthraxx/linux-hardened/$version.zip"
	"http://downloads.sourceforge.net/project/reiser4/reiser4-for-linux-4.x/reiser4-for-$reiserfs4patchver.patch.gz")
BOOTSTRAP=yes
NO_RUN_STRIP=1

yconfig() {
	while [ $# -ne 0 ]; do
		./scripts/config --enable $1
		shift 1
	done
}

mconfig() {
	while [ $# -ne 0 ]; do
		./scripts/config --module $1
		shift 1
	done
}

nconfig() {
	while [ $# -ne 0 ]; do
		./scripts/config --disable $1
		shift 1
	done
}

varconfig() {
	FUONE="$1"
	FUTWO="$2"

	./scripts/config --set-val "$FUONE" "$FUTWO"
}

strconfig() {
	FUONE="$1"
	FUTWO="$2"

	./scripts/config --set-str "$FUONE" "$FUTWO"
}

generate_config() {
	case $BARCH in
		x86_64|i586)
			SUBKARCH="x86"
			;;
		*)
			SUBKARCH="$XKARCH"
			;;
	esac

	case $BARCH in
		x86_64)
			export DEFCONFIG="x86_64_defconfig"
			;;
		i586)
			export DEFCONFIG="i386_defconfig"
			;;
		ppc64le)
			export DEFCONFIG="powernv_defconfig"
			;;
		ppc64)
			if [ "$PS3" = "yes" ]; then
				export DEFCONFIG="ps3_defconfig"
			else
				export DEFCONFIG="g5_defconfig"
			fi
			;;
		ppc)
			export DEFCONFIG="pmac32_defconfig"
			;;
		riscv64|riscv32)
			export DEFCONFIG="defconfig"
			;;
		*)
			echo "Architecture is not set or is not supported by Ataraxia Linux"
			exit 1
	esac

	if [ "$CROSS" = "yes" ]; then
		make ARCH=$XKARCH CROSS_COMPILE=${CROSS_COMPILE} $DEFCONFIG
	else
		make ARCH=$XKARCH $DEFCONFIG
	fi

	case $BARCH in
		x86_64)
			yconfig 64BIT PCI BLK_DEV_SD ATA ATA_SFF ATA_BMDMA ATA_PIIX \
				E1000 SERIAL_8250 SERIAL_8250_CONSOLE RTC_CLASS IA32_EMULATION \
				EFI EFI_STUB EFI_MIXED EFI_VARS FB_EFI EFI_RUNTIME_MAP EFIVAR_FS \
				NUMA AMD_NUMA NODES_SPAN_OTHER_NODES NEED_MULTIPLE_NODES USE_PERCPU_NUMA_NODE_ID ACPI_NUMA \
				MICROCODE MICROCODE_EARLY MICROCODE_INTEL MICROCODE_AMD
			nconfig NUMA_EMU XEN_DEBUG_FS
			mconfig KVM_INTEL KVM_AMD FB_HYPERV VBOXGUEST HYPERV HYPERV_UTILS \
				HYPERV_MOUSE HYPERV_STORAGE HYPERV_NET HYPERV_BALLOON
			varconfig XEN_BALLOON_MEMORY_HOTPLUG_LIMIT 512
			varconfig NODES_SHIFT 6
			;;
		i586)
			yconfig M586 PCI BLK_DEV_SD ATA ATA_SFF ATA_BMDMA ATA_PIIX \
				E1000 SERIAL_8250 SERIAL_8250_CONSOLE RTC_CLASS \
				EFI EFI_STUB EFI_MIXED EFI_VARS FB_EFI EFI_RUNTIME_MAP EFIVAR_FS \
				MICROCODE MICROCODE_EARLY MICROCODE_INTEL MICROCODE_AMD
			mconfig KVM_INTEL KVM_AMD FB_HYPERV VBOXGUEST HYPERV HYPERV_UTILS \
				HYPERV_MOUSE HYPERV_STORAGE HYPERV_NET HYPERV_BALLOON
			mconfig KVM_INTEL KVM_AMD
			;;
		ppc64le)
			yconfig POWER8_CPU TARGET_CPU_BOOL
			strconfig TARGET_CPU power8
			;;
		riscv64)
			yconfig RISCV_ISA_C RISCV_ISA_A FPU SIFIVE_PLIC
			;;
		riscv32)
			yconfig 32BIT ARCH_RV32I MAXPHYSMEM_2GB LBDAF GENERIC_ATOMIC64 \
				GENERIC_LIB_ASHLDI3 GENERIC_LIB_ASHRDI3 GENERIC_LIB_LSHRDI3 \
				GENERIC_LIB_UCMPDI2 GENERIC_LIB_UMODDI3 \
				RISCV_ISA_C RISCV_ISA_A FPU SIFIVE_PLIC
			nconfig ARCH_RV64I
			;;
	esac

	nconfig EMBEDDED KERNEL_GZIP KERNEL_BZIP2 KERNEL_LZMA KERNEL_LZO KERNEL_LZ4 \
		HZ_100 HZ_250 HZ_1000 CC_OPTIMIZE_FOR_PERFORMANCE PREEMPT_NONE PREEMPT_VOLUNTAR SCHED_DEBUG \
		COMPAT_VDSO FW_LOADER_USER_HELPER SYSFS_DEPRECATED L2TP_DEBUGFS CFG80211_DEBUGFS \
		CFG80211_INTERNAL_REGDB CFG80211_CRDA_SUPPORT DEFAULT_SECURITY_SELINUX DEFAULT_SECURITY_SMACK \
		DEFAULT_SECURITY_APPARMOR DEFAULT_SECURITY_DAC MODULE_COMPRESS_GZ

	# core
	yconfig SMP EARLY_PRINTK BINFMT_ELF BINFMT_SCRIPT NO_HZ HIGH_RES_TIMERS HZ_300 PREEMPT CC_OPTIMIZE_FOR_SIZE \
		BLK_DEV FRAMEBUFFER_CONSOLE_DEFERRED_TAKEOVER LOGO_LINUX_CLUT224 KERNEL_XZ \
		MODULES MODULE_FORCE_LOAD MODULE_UNLOAD MODULE_FORCE_UNLOAD MODULE_SRCVERSION_ALL MODULE_COMPRESS MODULE_COMPRESS_XZ \
		HAVE_KERNEL_GZIP HAVE_KERNEL_BZIP2 HAVE_KERNEL_LZMA HAVE_KERNEL_XZ HAVE_KERNEL_LZO HAVE_KERNEL_LZ4 \
		RD_GZIP RD_BZIP2 RD_LZMA RD_XZ RD_LZO RD_LZ4 IKCONFIG IKPROC GPIO_SYSFS IKPRO DEVTMPFS TMPFS UNIX SHMEM \
		CGROUPS NAMESPACES IPC_NS NET_NS SYSVIP BINFMT_SCRIPT DEVTMPFS DEVTMPFS_MOUNT EXPERT \
		DMIID EPOLL FHANDLE FS_POSIX_ACL EXPORTFS FILE_LOCKING MANDATORY_FILE_LOCKING \
		FS_ENCRYPTION FSNOTIFY DNOTIFY INOTIFY_USER FANOTIFY GENERIC_ACL IPV6 NET NET_NS PROC_FS \
		PROC_KCORE PROC_SYSCTL PROC_PAGE_MONITOR PROC_DEVICETREE TIMER_STATS SECCOMP SECCOMP_FILTER \
		SIGNALFD SYSFS TIMERFD TMPFS_POSIX_ACL TMPFS_XATTR ANON_INODES BLOCK EVENTFD FSNOTIFY \
		INET NLATTR CGROUP_SCHED FAIR_GROUP_SCHED CFS_BANDWIDTH SCHEDSTATS PID_NS NET_NS SECCOMP_FILTER \
		USER_NS ADVISE_SYSCALLS I2C_CHARDEV PARTITION_ADVANCED EFI_PARTITION OSF_PARTITION \
		AMIGA_PARTITION SGI_PARTITION SUN_PARTITION KARMA_PARTITION MAC_PARTITION MAGIC_SYSRQ \
		AUTOFS4_FS BLK_DEV_BSG CGROUPS CHECKPOINT_RESTORE CMDLINE_BOOL SYSCTL \
		POSIX_MQUEUE POSIX_MQUEUE_SYSCTL KERNFS SYSFS CONFIGFS_FS MISC_FILESYSTEMS \
		NLS NLS_CODEPAGE_437 NLS_ASCII NLS_ISO8859_1 NLS_UTF8 INPUT INPUT_LEDS \
		INPUT_FF_MEMLESS INPUT_POLLDEV INPUT_EVDEV INPUT_KEYBOARD KEYBOARD_ATKBD \
		KEYBOARD_GPIO KEYBOARD_GPIO_POLLED INPUT_MOUSEDEV INPUT_MOUSE MOUSE_PS2 MOUSEDEV MOUSE_PS2 MOUSE_PS2_ALPS MOUSE_PS2_BYD \
		MOUSE_PS2_LOGIPS2PP MOUSE_PS2_SYNAPTICS MOUSE_SYNAPTICS_I2C MOUSE_SYNAPTICS_USB MOUSE_PS2_CYPRESS MOUSE_PS2_LIFEBOOK MOUSE_PS2_TRACKPOINT INPUT_MISC INPUT_UINPUT \
		KEYBOARD_ADP5588 KEYBOARD_ADP558 KEYBOARD_QT1070 KEYBOARD_QT2160 KEYBOARD_DLINK_DIR685 KEYBOARD_LKKBD KEYBOARD_TCA6416 \
		KEYBOARD_TCA8418 KEYBOARD_MATRIX KEYBOARD_LM8323 KEYBOARD_LM8333 KEYBOARD_MAX7359 KEYBOARD_MCS KEYBOARD_MPR121 \
		KEYBOARD_NEWTON KEYBOARD_OPENCORES KEYBOARD_SAMSUNG KEYBOARD_STOWAWAY KEYBOARD_SUNKBD KEYBOARD_TM2_TOUCHKEY KEYBOARD_XTKBD \
		SERIO SERIO_I8042 SERIO_SERPORT SERIO_LIBPS2 HID HIDRAW UHID HID_GENERIC USB_HID USB_HIDDE KEYBOARD_IMX INPUT_TOUCHSCREEN TOUCHSCREEN_PROPERTIES \
		NEW_LEDS LEDS_CLASS VIRTUALIZATION IRQ_BYPASS_MANAGER KVM_GUEST FB_VESA \
		NET INET NETFILTER NETFILTER_ADVANCED AUDIT AUDITSYSCALL \
		SYSVIPC IP_VS_PROTO_TCP IP_VS_PROTO_UDP XFRM XFRM_USER XFRM_ALGO \
		NET_L3_MASTER_DEV INET_XFRM_MODE_TRANSPOR NET_L3_MASTER_DEV \
		NAMESPACES NET_NS PID_NS IPC_NS UTS_NS CGROUPS CGROUP_CPUACCT \
		CGROUP_DEVICE FREEZER CGROUP_FREEZER CGROUP_SCHED CPUSETS MEMCG \
		KEYS NF_NAT_NEEDED POSIX_MQUEUE USER_NS SECCOMP CGROUP_PIDS MEMCG_SWAP \
		MEMCG_SWAP_ENABLED LEGACY_VSYSCALL_EMULAT BLK_CGROUP BLK_DEV_THROTTLING \
		CGROUP_PERF CGROUP_HUGETLB CGROUP_NET_PRIO CFS_BANDWIDTH FAIR_GROUP_SCHED \
		RT_GROUP_SCHED IP_VS_NFCT NETPOLL NET_POLL_CONTROLLER NETDEVICES NET_CORE \
		NETPOLL NET_POLL_CONTROLLER PACKET UNIX INET IP_MULTICAST INET_LRO TCP_CONG_CUBIC \
		IP_MROUTE PV6_NDISC_NODETYPE NET_PTP_CLASSIFY HAVE_NET_DSA DNS_RESOLVER \
		RPS RFS_ACCEL XPS NET_RX_BUSY_POLL BQL NET_FLOW_LIMIT DST_CACHE \
		MAY_USE_DEVLINK OF_NET RFKILL RFKILL_PM RFKILL_LEDS HAVE_NET_DSA \
		WIRELESS WEXT_CORE CFG80211_DEFAULT_PS CFG80211_INTERNAL_REGDB \
		MAC80211_HAS_RC MAC80211_RC_MINSTREL MAC80211_RC_MINSTREL_HT \
		MAC80211_RC_MINSTREL_VHT MAC80211_RC_DEFAULT_MINSTREL MAC80211_LEDS \
		ATM_DRIVERS USB_NET_DRIVERS IEEE802154_DRIVERS V4L_PLATFORM_DRIVERS V4L_MEM2MEM_DRIVERS V4L_TEST_DRIVERS DVB_PLATFORM_DRIVERS \
		CEC_PLATFORM_DRIVERS SDR_PLATFORM_DRIVERS SND_DRIVERS VIRT_DRIVERS COMEDI_MISC_DRIVERS COMEDI_PCI_DRIVERS COMEDI_PCMCIA_DRIVERS \
		COMEDI_USB_DRIVERS MOUSE_APPLETOUCH DRM \
		NET_VENDOR_3COM NET_VENDOR_ADAPTEC NET_VENDOR_AGERE NET_VENDOR_ALACRITECH NET_VENDOR_ALTEON NET_VENDOR_AMAZON NET_VENDOR_AMD \
		NET_VENDOR_AQUANTIA NET_VENDOR_ARC NET_VENDOR_ATHEROS NET_VENDOR_AURORA NET_VENDOR_BROADCOM _NET_VENDOR_BROCADE NET_VENDOR_CAVIUM \
		NET_VENDOR_CHELSIO NET_VENDOR_CISCO NET_VENDOR_CORTINA NET_VENDOR_DEC NET_VENDOR_DLINK NET_VENDOR_EMULEX NET_VENDOR_EZCHIP NET_VENDOR_EXAR \
		NET_VENDOR_FUJITSU NET_VENDOR_HP NET_VENDOR_HUAWEI NET_VENDOR_INTEL NET_VENDOR_EXAR NET_VENDOR_MARVELL NET_VENDOR_MELLANOX NET_VENDOR_MICREL \
		NET_VENDOR_MICROCHIP NET_VENDOR_MYRI NET_VENDOR_NATSEMI NET_VENDOR_NETRONOME NET_VENDOR_NI NET_VENDOR_8390 NET_VENDOR_NVIDIA NET_VENDOR_OKI \
		NET_VENDOR_QLOGIC NET_VENDOR_QUALCOMM NET_VENDOR_REALTEK NET_VENDOR_RENESAS NET_VENDOR_RDC NET_VENDOR_ROCKER NET_VENDOR_SAMSUNG NET_VENDOR_SEEQ \
		NET_VENDOR_SILAN NET_VENDOR_SIS NET_VENDOR_SOLARFLARE NET_VENDOR_SMSC NET_VENDOR_SOCIONEXT NET_VENDOR_STMICRO VENDOR_SUN NET_VENDOR_TEHUTI \
		NET_VENDOR_TI NET_VENDOR_VIA NET_VENDOR_WIZNET NET_VENDOR_XIRCOM NET_VENDOR_SYNOPSYS NET_VENDOR_IBM NET_VENDOR_MICROSEMI NET_VENDOR_RDC \
		NET_VENDOR_I825XX NET_VENDOR_3COM NET_VENDOR_NATSEMI NET_VENDOR_8390 \
		WLAN_VENDOR_ADMTEK WLAN_VENDOR_ATH WLAN_VENDOR_ATMEL WLAN_VENDOR_BROADCOM WLAN_VENDOR_CISCO WLAN_VENDOR_INTEL WLAN_VENDOR_INTERSIL \
		WLAN_VENDOR_MARVELL WLAN_VENDOR_MEDIATEK WLAN_VENDOR_RALINK WLAN_VENDOR_REALTEK WLAN_VENDOR_RSI WLAN_VENDOR_ST WLAN_VENDOR_TI WLAN_VENDOR_ZYDAS WLAN_VENDOR_QUANTENNA \
		PHYLIB SWPHY SWAP MEMCG_SWAP MEMCG_SWAP_ENABLED ZSMALLOC ZRAM \
		TTY SECURITY SECURITY_PATH SECURITY_NETWORK SECURITY_TOMOYO SECURITYFS KALLSYMS DEFAULT_SECURITY_TOMOYO \
		OPTIMIZE_INLINING LOGO_LINUX_CLUT224 KEXEC KEXEC_FILE MULTIUSER FILE_LOCKING MANDATORY_FILE_LOCKING NETWORK_FILESYSTEMS \
		SUNRPC SUNRPC_GSS SUNRPC_BACKCHANNEL SUNRPC_SWAP

	# core (modules)
	mconfig I2C_HID INPUT_GPIO_ROTARY_ENCODER INPUT_JOYDEV INPUT_POLLDEV INPUT_MATRIXKMAP KVM VHOST_NET \
		MACVTAP VXLAN INET_ESP IPVLAN DUMMY IP_VS_RR IP_VS NET_CLS_CGROU VETH MACVLAN MACSEC NETCONSOLE VIRTIO_NET \
		TUN PPP PPP_BSDCOMP PPP_DEFLATE PPP_MPPE PPPOE PPPOLAC PPPOPNS PPP_ASYNC SLHC L2TP L2TP_V3 L2TP_IP L2TP_ETH \
		IPV6_SIT STP NET_IP_TUNNEL IP_MROUTE INET_TUNNEL VLAN_8021Q LLC MAC80211 CFG80211

	# blocks
	yconfig BLK_DEV_INITRD BLK_DEV_LOOP BLK_DEV_RAM VIRTIO_BLK BLK_DEV_SD LK_DEV_SR CHR_DEV_SG \
		NVME_CORE BLK_DEV_NVME NVME_MULTIPATH NVME_FABRICS NVME_RDMA NVME_FC NVME_TARGET \
		NVME_TARGET_LOOP NVME_TARGET_RDMA NVME_TARGET_FC NVME_TARGET_FCLOOP BLK_DEV_NVME ATA ATA_ACPI \
		SATA_PMP SATA_AHCI SATA_AHCI_PLATFORM SATA_SIL24 ATA_SFF ATA_BMDMA ATA_PIIX \
		SATA_DWC SATA_DWC_OLD_DMA SATA_NV SATA_SIL SATA_SIS SATA_ULI SATA_VIA \
		PATA_ALI PATA_AMD PATA_ATIIXP PATA_JMICRON PATA_MARVELL PATA_SIS PATA_VIA PATA_ACPI ATA_GENERIC \
		SCSI SCSI_DMA BLK_DEV_SR CHR_DEV_SG SCSI_MULTI_LUN SCSI_SCAN_ASYNC SCSI_SAS_ATTRS \
		SCSI_SAS_LIBSAS SCSI_SAS_ATA SCSI_SAS_HOST_SMP SCSI_LOWLEVEL SCSI_MVSAS MEGARAID_SAS FIREWIRE_SBP2 RTS5208 \
		MMC PWRSEQ_EMMC PWRSEQ_SIMPLE PXP_MMC SSB_SDIOHOST_POSSIBLE SB_SDIOHOST MMC_BLOCK MMC_BLOCK_BOUNCE MMC_SDHCI \
		MMC_SDHCI_PCI MMC_SDHCI_ACPI MMC_SDHCI_IO_ACCESSORS MMC_SDHCI_PLTFM MMC_SDHCI_ESDHC_IMX MMC_REALTEK_PCI \
		MMC_TOSHIBA_PCI MMC_AML MMC_ARMMMCI MMC_BCM2835 MMC_BCM2835_DMA MMC_BCM2835_SDHOST \
		SCSI_LOWLEVEL ISCSI_TCP SCSI_ISCSI_ATTRS \
		DAX DM BLK_DEV_MD DM_DEBUG DM_UEVENT DM_DELAY DM_LOG_WRITES DM_MQ_DEFAULT \
		DM_MULTIPATH DM_ZERO DM_SNAPSHOT DM_LOG_USERSPACE MD BLK_DEV_DM DM_CRYPT \
		DM_MIRROR MD MD_AUTODETECT MD_LINEAR MD_RAID0 MD_RAID1 MD_RAID10 ASYNC_CORE \
		ASYNC_MEMCP ASYNC_XOR ASYNC_PQ ASYNC_RAID6_RECOV MD_RAID456 MD_MULTIPATH \
		BLK_WBT BLK_WBT_SQ BLK_WBT_MQ IOSCHED_BFQ DM_THIN_PROVISIONING
	nconfig SCSI_MVSAS_DEBUG

	# crypto
	yconfig CRYPTO_HW CRYPTO_ANUBIS CRYPTO_BLOWFISH CRYPTO_CAMELLIA CRYPTO_CAST5 CRYPTO_CAST6 \
		CRYPTO_FCRYPT CRYPTO_KHAZAD CRYPTO_SERPENT CRYPTO_TEA CRYPTO_TGR192 CRYPTO_TWOFISH \
		CRYPTO_TWOFISH_COMMON CRYPTO_WP512 CRYPTO_AES CRYPTO_ACOMP2 CRYPTO_AEAD CRYPTO_AEAD2 \
		CRYPTO_AUTHENC CRYPTO_CBC CRYPTO_CCM CRYPTO_CMAC CRYPTO_CRC32 CRYPTO_CRC32C CRYPTO_CTR \
		CRYPTO_CTS CRYPTO_DEFLATE CRYPTO_DES CRYPTO_ECB CRYPTO_ECDH CRYPTO_ECHAINIV \
		CRYPTO_FCRYPT CRYPTO_GCM CRYPTO_XCBC CRYPTO_GF128MUL CRYPTO_GHASH CRYPTO_HASH \
		CRYPTO_HMAC CRYPTO_DEV_CCP CRYPTO_DEV_CCP_CRYPTO CRYPTO_DEV_CCP_DD CRYPTO_DEV_SP_CCP \
		CRYPTO_DEV_GEODE CRYPTO_DEV_HIFN_795X CRYPTO_DEV_HIFN_795X_RNG CRYPTO_DEV_PADLOCK \
		CRYPTO_DEV_PADLOCK_AES CRYPTO_DEV_PADLOCK_SHA CRYPTO_DEV_TALITOS CRYPTO_DEV_TALITOS1 \
		CRYPTO_DEV_TALITOS2 CRYPTO_KPP CRYPTO_MANAGER CRYPTO_MANAGER2 CRYPTO_MD4 CRYPTO_MD5 \
		CRYPTO_MD5_OCTEON CRYPTO_MICHAEL_MIC CRYPTO_PCBC CRYPTO_PCOMP CRYPTO_PCOMP2 \
		CRYPTO_RSA CRYPTO_RMD160 CRYPTO_DRBG CRYPTO_DRBG_HMAC CRYPTO_DRBG_MENU \
		CRYPTO_JITTERENTROPY CRYPTO_RNG2 CRYPTO_SHA1 CRYPTO_SHA1_OCTEON CRYPTO_SHA1_SSSE3 \
		ONFIG_CRYPTO_SHA256 CRYPTO_SHA256_OCTEON CRYPTO_SHA256_SSSE3 CRYPTO_SHA512 CRYPTO_SHA512_OCTEON \
		CRYPTO_SHA512_SSSE3 CRYPTO_USER_API CRYPTO_USER_API_HASH CRYPTO_USER_API_SKCIPHER CRYPTO_XTS \
		CRYPTO_CAMELLIA_X86_64 CRYPTO_BLOWFISH_X86_64 CRYPTO_TWOFISH_X86_64 \
		CRYPTO_TWOFISH_X86_64_3WAY CRYPTO_SERPENT_SSE2_X86_64 CRYPTO_CAMELLIA_AESNI_AVX_X86_64 \
		CRYPTO_CAST5_AVX_X86_64 CRYPTO_CAST6_AVX_X86_64 CRYPTO_TWOFISH_AVX_X86_64 \
		CRYPTO_SERPENT_AVX_X86_64 CRYPTO_CAMELLIA_AESNI_AVX2_X86_64 CRYPTO_SERPENT_AVX2_X86_64 \
		CRYPTO_SERPENT_SSE2_586 CRYPTO_AES_X86_64 CRYPTO_TWOFISH_586
	nconfig CRYPTO_DRBG_HASH

	yconfig DRM_RADEON DRM_AMDGPU DRM_AMDGPU_SI DRM_AMDGPU_CIK \
		DRM_NOUVEAU DRM_NOUVEAU_BACKLIGHT DRM_VMWGFX DRM_VMWGFX_FBCON \
		DRM_I915 DRM_I915_ALPHA_SUPPORT DRM_I915_CAPTURE_ERROR DRM_I915_COMPRESS_ERROR DRM_I915_USERPTR DRM_I915_GVT DRM_I915_GVT_KVMGT \
		VIRTIO_GPU DRM_QLX DRM_GMA500 DRM_GMA600 DRM_GMA3600 DRM_CIRRUS_QEMU DRM_I915_PRELIMINARY_HW_SUPPORT DRM_FBDEV_EMULATION R6040

	# usb
	yconfig SCSI_DMA SCSI_MULTI_LUN USB_STORAGE USB_UAS USB_SUPPORT USB_COMMON USB_ARCH_HAS_HCD USB USB_ANNOUNCE_NEW_DEVICES \
		USB_XHCI_HCD USB_XHCI_PCI USB_EHCI_HCD USB_EHCI_ROOT_HUB_TT USB_EHCI_TT_NEWSCHED USB_EHCI_PCI USB_OHCI_HCD USB_OHCI_HCD_PCI USB_UHCI_HCD \
		USB_DWCOTG USB_PHY USB_MXS_PHY AMLOGIC_USB USB_DWC_OTG_HCD USB_HOST_ELECT_TEST USB_DEFAULT_PERSIST UCSI MFD_RTSX_USB \
		MMC_REALTEK_USB MEMSTICK_REALTEK_USB USB_MASS_STORAGE U_SERIAL_CONSOLE USB_GADGET
	mconfig USB_G_SERIAL

	mconfig USB_ACM USB_MON

	# filesystems
	yconfig SQUASHFS SQUASHFS_DECOMP_MULTI SQUASHFS_FILE_DIRECT \
		SQUASHFS_LZ4 SQUASHFS_LZO SQUASHFS_XATTR SQUASHFS_XZ SQUASHFS_ZLIB SQUASHFS_ZSTD \
		OVERLAY_FS OVERLAY_FS_REDIRECT_DIR _OVERLAY_FS_INDEX OVERLAY_FS_REDIRECT_ALWAYS_FOLLOW \
		OVERLAY_FS_NFS_EXPORT OVERLAY_FS_XINO_AUTO VERLAY_FS_METACOPY \
		REISER4_FS EXT4_FS EXT4_USE_FOR_EXT2 EXT4_FS_POSIX_ACL EXT4_FS_SECURITY EXT4_USE_FOR_EXT2 \
		FAT_FS VFAT_FS FAT_DEFAULT_UTF8 NTFS_FS NTFS_RW JBD2 FS_MBCACHE UBIFS_FS UBIFS_FS_LZO UBIFS_FS_ZLIB \
		BTRFS_FS BTRFS_FS_POSIX_ACL BTRFS_FS_CHECK_INTEGRITY REISERFS_FS REISERFS_FS_XATTR JFS_FS JFS_SECURITY \
		XFS_FS XFS_QUOTA CRYPTO_LZ4 CRYPTO_LZ4HC \
		F2FS_FS F2FS_FS_XATTR F2FS_FS_POSIX_ACL F2FS_FS_SECURITY F2FS_STAT_FS F2FS_CHECK_FS ISO9660_FS JOLIET ZISOFS \
		UDF_FS UDF_NLS MISC_FILESYSTEMS HFS_FS HFSPLUS_FS 9P_FS 9P_FS_POSIX_ACL 9P_FS_SECURITY 9P_FSCACHE \
		NFS_V2 NFS_V3 NFS_V3_ACL NFS_V4 NFS_SWAP NFS_V4_1 NFS_V4_2 PNFS_FILE_LAYOUT NFS_V4_1_MIGRATION ROOT_NFS \
		NFS_USE_KERNEL_DNS GRACE_PERIOD LOCKD LOCKD_V4 NFS_COMMON CIFS_STATS CIFS_STATS2 CIFS_SMB2 CIFS_SMB311 CIFS_FSCACHE \
		CIFS_UPCALL CIFS_XATTR CIFS_POSIX CIFS_ACL
	nconfig SQUASHFS_FILE_CACHE SQUASHFS_DECOMP_SINGLE SQUASHFS_DECOMP_MULTI_PERCPU SQUASHFS_4K_DEVBLK_SIZE SQUASHFS_EMBEDDED \
		NFSD NFS_USE_LEGACY_DNS CIFS_WEAK_PW_HASH CIFS_DEBUG CIFS_DEBUG2 CIFS_DFS_UPCALL
	mconfig DMI_SYSFS FUSE_FS NFS_FS PNFS_FLEXFILE_LAYOUT RPCSEC_GSS_KRB5 CIFS

	# hid
	mconfig HID_A4TECH HID_APPLE HID_AUREAL HID_BELKIN HID_CHERRY HID_CHICONY HID_CYPRESS \
		DRAGONRISE_FF HID_EZKEY HID_HBGIC HID_KYE HID_GYRATION HID_TWINHAN HID_KENSINGTON HID_LCPOWER \
		HID_LENOVO HID_LOGITECH HID_LOGITECH_DJ HID_LOGITECH_HIDPP LOGITECH_FF LOGIRUMBLEPAD2_FF \
		LOGIG940_FF LOGIWHEELS_FF HID_MICROSOFT HID_MONTEREY HID_ORTEK HID_OUYA HID_PANTHERLORD \
		PANTHERLORD_FF HID_PENMOUNT HID_PETALYNX HID_PICOLCD_FB HID_PICOLCD_BACKLIGHT HID_PICOLCD_LCD \
		HID_PICOLCD_LEDS HID_SAMSUNG HID_SONY SONY_FF HID_SPINELPLUS HID_SUNPLUS HID_RMI SMARTJOYPLUS_FF \
		HID_TIVO HID_TOPSEED HID_WIIMOTE_EXT HID_XINMO HID_ZYDACRON INTEL_ISH_HID
	mconfig HID_DRAGONRISE HID_LENOVO_TPKBD HID_PICOLCD HID_PS3REMOTE HID_SMARTJOYPLUS HID_WIIMOTE

	# virtio
	yconfig DRM_VIRTIO_GPU NET_9P NET_9P_VIRTIO RPMSG_VIRTIO VIRTIO_BALLOON \
		VIRTIO_CONSOLE VIRTIO_INPUT VIRTIO_MENU VIRTIO_MMIO VIRTIO_MMIO_CMDLINE_DEVICES \
		VIRTIO_VSOCKETS VIRTIO_BLK VIRTIO_PCI VIRTIO_PCI_LEGACY

	# netfilter
	yconfig NF_NAT_NEEDED BPFILTER
	mconfig NETFILTER_NETLINK NETFILTER_NETLINK_LOG NF_CONNTRACK NF_CONNTRACK_FTP NF_CONNTRACK_IRC \
		NF_CONNTRACK_BROADCAST NF_CONNTRACK_NETBIOS_NS NF_CONNTRACK_SIP NF_CT_NETLINK \
		NF_NAT NF_NAT_FTP NF_NAT_IRC NF_NAT_SIP NETFILTER_XTABLES NETFILTER_XT_NAT \
		NETFILTER_XT_MATCH_ADDRTYPE NETFILTER_XT_MATCH_CONNTRACK NETFILTER_XT_MATCH_IPRANGE \
		NETFILTER_XT_MATCH_OWNER NETFILTER_XT_MATCH_STATE NF_DEFRAG_IPV4 NF_CONNTRACK_IPV4 \
		NF_REJECT_IPV4 NF_NAT_IPV4 NF_NAT_MASQUERADE_IPV4 IP_NF_IPTABLES IP_NF_FILTER \
		IP_NF_TARGET_REJECT IP_NF_NAT IP_NF_TARGET_MASQUERADE IP_NF_MANGLE \
		NF_DEFRAG_IPV6 NF_CONNTRACK_IPV6 NF_REJECT_IPV6 NF_NAT_IPV6 NF_NAT_MASQUERADE_IPV6 \
		IP6_NF_IPTABLES IP6_NF_FILTER IP6_NF_TARGET_REJECT IP6_NF_MANGLE IP6_NF_NAT \
		IP6_NF_TARGET_MASQUERADE NF_NAT_FTP NF_CONNTRACK_FTP NF_NAT_TFTP \
		BRIDGE_NETFILTER NF_NAT_IPV4 IP_NF_FILTER IP_NF_TARGET_MASQUERADE \
		NETFILTER_XT_MATCH_ADDRTYPE NETFILTER_XT_MATCH_CONNTRACK NETFILTER_XT_MATCH_IPVS \
		IP_NF_NAT NF_NAT

	# sound
	yconfig SOUND SND SND_TIMER SND_PCM_TIMER SND_HRTIMER SND_DYNAMIC_MINOR SND_VERBOSE_PROCFS SND_DMA_SGBUF
	nconfig SOUND_OSS_CORE SND_SUPPORT_OLD_API

	# bluetooth
	mconfig BT BT_BREDR BT_RFCOMM BT_RFCOMM_TTY BT_HIDP BT_INTEL BT_BCM BT_RTL BT_HCIBTUSB BT_HCIBTSDIO \
		BT_HCIBCM203X BT_HCIBFUSB BT_HCIUART BT_HCIBCM203X BT_HCIBPA10X BT_HCIBFUSB BT_MRVL BT_MRVL_SDIO BT_ATH3K
	yconfig BT_HCIUART_H4 BT_HCIUART_BCSP BT_HCIUART_ATH3K BT_HCIUART_LL BT_HCIUART_3WIRE BT_HCIUART_INTEL \
		BT_HCIUART_BCM BT_HCIUART_QCA BT_HCIUART_AG6XX BT_HCIUART_MRVL BT_HCIBTUSB_BCM BT_HCIBTUSB_RTL \
		BT_HS BT_LE BT_LEDS

	nconfig BT_HCIVHCI BT_SELFTEST BT_DEBUGFS BT_BNEP

	mconfig DRM_RADEON DRM_AMDGPU DRM_AMDGPU_SI DRM_AMDGPU_CIK \
		DRM_NOUVEAU DRM_NOUVEAU_BACKLIGHT DRM_VMWGFX DRM_VMWGFX_FBCON \
		DRM_I915 DRM_I915_ALPHA_SUPPORT DRM_I915_CAPTURE_ERROR DRM_I915_COMPRESS_ERROR DRM_I915_USERPTR DRM_I915_GVT DRM_I915_GVT_KVMGT \
		VIRTIO_GPU DRM_QLX DRM_GMA500 DRM_GMA600 DRM_GMA3600 DRM_CIRRUS_QEMU DRM_I915_PRELIMINARY_HW_SUPPORT DRM_FBDEV_EMULATION R6040

	# Touchscreen drivers
	mconfig TOUCHSCREEN_88PM860X TOUCHSCREEN_ADS7846 TOUCHSCREEN_AD7877 TOUCHSCREEN_AD7879 TOUCHSCREEN_AD7879_I2C TOUCHSCREEN_AD7879_SPI TOUCHSCREEN_AR1021_I2C \
		TOUCHSCREEN_ATMEL_MXT TOUCHSCREEN_ATMEL_MXT_T37 TOUCHSCREEN_AUO_PIXCIR TOUCHSCREEN_BU21013 TOUCHSCREEN_CHIPONE_ICN8318 TOUCHSCREEN_CY8CTMG110 TOUCHSCREEN_CYTTSP_CORE \
		TOUCHSCREEN_CYTTSP_I2C TOUCHSCREEN_CYTTSP_SPI TOUCHSCREEN_CYTTSP4_CORE TOUCHSCREEN_CYTTSP4_I2C TOUCHSCREEN_CYTTSP4_SPI TOUCHSCREEN_DA9034 TOUCHSCREEN_DA9052 \
		TOUCHSCREEN_DYNAPRO TOUCHSCREEN_HAMPSHIRE TOUCHSCREEN_EETI TOUCHSCREEN_EGALAX TOUCHSCREEN_EGALAX_SERIAL TOUCHSCREEN_EXC3000 TOUCHSCREEN_FUJITSU TOUCHSCREEN_GOODIX \
		TOUCHSCREEN_HIDEEP TOUCHSCREEN_ILI210X TOUCHSCREEN_S6SY761 TOUCHSCREEN_GUNZE TOUCHSCREEN_EKTF2127 TOUCHSCREEN_ELAN TOUCHSCREEN_ELO TOUCHSCREEN_WACOM_W8001 \
		TOUCHSCREEN_WACOM_I2C TOUCHSCREEN_MAX11801 TOUCHSCREEN_MCS5000 TOUCHSCREEN_MMS114 TOUCHSCREEN_MELFAS_MIP4 TOUCHSCREEN_MTOUCH \
		TOUCHSCREEN_IMX6UL_TSC TOUCHSCREEN_INEXIO TOUCHSCREEN_MK712 TOUCHSCREEN_PENMOUNT TOUCHSCREEN_EDT_FT5X06 TOUCHSCREEN_TOUCHRIGHT TOUCHSCREEN_TOUCHWIN \
		TOUCHSCREEN_TI_AM335X_TSC TOUCHSCREEN_UCB1400 TOUCHSCREEN_PIXCIR TOUCHSCREEN_WDT87XX_I2C TOUCHSCREEN_WM831X TOUCHSCREEN_WM97XX TOUCHSCREEN_WM9705 \
		TOUCHSCREEN_WM9712 TOUCHSCREEN_WM9713 TOUCHSCREEN_USB_COMPOSITE TOUCHSCREEN_MC13783 TOUCHSCREEN_USB_EGALAX TOUCHSCREEN_USB_PANJIT TOUCHSCREEN_USB_3M \
		TOUCHSCREEN_USB_ITM TOUCHSCREEN_USB_ETURBO TOUCHSCREEN_USB_GUNZE TOUCHSCREEN_USB_DMC_TSC10 TOUCHSCREEN_USB_IRTOUCH TOUCHSCREEN_USB_IDEALTEK \
		TOUCHSCREEN_USB_GENERAL_TOUCH TOUCHSCREEN_USB_GOTOP TOUCHSCREEN_USB_JASTEC TOUCHSCREEN_USB_ELO TOUCHSCREEN_USB_E2I TOUCHSCREEN_USB_ZYTRONIC \
		TOUCHSCREEN_USB_ETT_TC45USB TOUCHSCREEN_USB_NEXIO TOUCHSCREEN_USB_EASYTOUCH TOUCHSCREEN_TOUCHIT213 TOUCHSCREEN_TSC_SERIO TOUCHSCREEN_TSC200X_CORE \
		TOUCHSCREEN_TSC2004 TOUCHSCREEN_TSC2005 TOUCHSCREEN_TSC2007 TOUCHSCREEN_TSC2007_IIO TOUCHSCREEN_PCAP TOUCHSCREEN_RM_TS TOUCHSCREEN_SILEAD \
		TOUCHSCREEN_SIS_I2C TOUCHSCREEN_ST1232 TOUCHSCREEN_STMFTS TOUCHSCREEN_STMPE TOUCHSCREEN_SUR40 TOUCHSCREEN_SURFACE3_SPI TOUCHSCREEN_SX8654 \
		TOUCHSCREEN_TPS6507X TOUCHSCREEN_ZET6223 TOUCHSCREEN_ZFORCE TOUCHSCREEN_COLIBRI_VF50 TOUCHSCREEN_ROHM_BU21023

	# Joystick drivers
	mconfig JOYSTICK_ANALOG JOYSTICK_A3D JOYSTICK_ADI JOYSTICK_COBRA JOYSTICK_GF2K JOYSTICK_GRIP JOYSTICK_GRIP_MP \
		JOYSTICK_GUILLEMOT JOYSTICK_INTERACT JOYSTICK_SIDEWINDER JOYSTICK_TMDC JOYSTICK_IFORCE JOYSTICK_IFORCE_USB \
		JOYSTICK_IFORCE_232 JOYSTICK_WARRIOR JOYSTICK_MAGELLAN JOYSTICK_SPACEORB JOYSTICK_SPACEBALL JOYSTICK_STINGER \
		JOYSTICK_TWIDJOY JOYSTICK_ZHENHUA JOYSTICK_DB9 JOYSTICK_GAMECON JOYSTICK_TURBOGRAFX JOYSTICK_AS5011 JOYSTICK_JOYDUMP \
		JOYSTICK_XPAD JOYSTICK_XPAD_FF JOYSTICK_XPAD_LEDS JOYSTICK_WALKERA0701 JOYSTICK_PSXPAD_SPI JOYSTICK_PSXPAD_SPI_FF JOYSTICK_PXRC

	# Tablet drivers
	mconfig TABLET_USB_ACECAD TABLET_USB_AIPTEK TABLET_USB_GTCO TABLET_USB_HANWANG TABLET_USB_KBTAB TABLET_USB_PEGASUS TABLET_SERIAL_WACOM4

	# Sound drivers
	mconfig SND_ALOOP SND_VIRMIDI SND_MTPAV SND_MTS64 SND_SERIAL_U16550 SND_MPU401 SND_PORTMAN2X4 \
		SND_AC97_POWER_SAVE SND_SB_COMMON SND_PCI SND_AD1889 SND_ALS300 SND_ALS4000 SND_ALI5451 SND_ASIHPI SND_ATIIXP \
		SND_ATIIXP_MODEM SND_AU8810 SND_AU8820 SND_AU8830 SND_AW2 SND_AZT3328 SND_BT87X SND_CA0106 SND_CMIPCI SND_OXYGEN_LIB \
		SND_OXYGEN SND_CS4281 SND_CS46XX SND_CS46XX_NEW_DSP SND_CTXFI SND_DARLA20 SND_GINA20 SND_LAYLA20 SND_DARLA24 \
		SND_GINA24 SND_LAYLA24 SND_MONA SND_MIA SND_ECHO3G SND_INDIGO SND_INDIGOIO SND_INDIGODJ SND_INDIGOIOX \
		SND_INDIGODJX SND_EMU10K1 SND_EMU10K1_SEQ SND_EMU10K1X SND_ENS1370 SND_ENS1371 SND_ES1938 SND_ES1968 \
		SND_ES1968_INPUT SND_ES1968_RADIO SND_FM801 SND_FM801_TEA575X_BOOL SND_HDSP SND_HDSPM SND_ICE1712 SND_ICE1724 \
		SND_INTEL8X0 SND_INTEL8X0M SND_KORG1212 SND_LOLA SND_LX6464ES SND_MAESTRO3 SND_MAESTRO3_INPUT SND_MIXART \
		SND_NM256 SND_PCXHR SND_RIPTIDE SND_RME32 SND_RME96 SND_RME9652 SND_SONICVIBES SND_TRIDENT SND_VIA82XX \
		SND_VIA82XX_MODEM SND_VIRTUOSO SND_VX222 SND_YMFPCI

	# HD-Audio drivers
	mconfig SND_HDA SND_HDA_INTEL SND_HDA_HWDEP SND_HDA_RECONFIG SND_HDA_INPUT_BEEP SND_HDA_PATCH_LOADER \
		SND_HDA_CODEC_REALTEK _SND_HDA_CODEC_ANALOG SND_HDA_CODEC_SIGMATEL SND_HDA_CODEC_VIA SND_HDA_CODEC_HDMI \
		SND_HDA_CODEC_CIRRUS ND_HDA_CODEC_CONEXANT SND_HDA_CODEC_CA0110 SND_HDA_CODEC_CA0132 SND_HDA_CODEC_CA0132_DSP \
		SND_HDA_CODEC_CMEDIA SND_HDA_CODEC_SI3054 SND_HDA_GENERIC SND_HDA_CORE SND_HDA_DSP_LOADER SND_HDA_I915 \
		SND_HDA_EXT_COR SND_SPI SND_USB SND_USB_AUDIO SND_USB_UA101 SND_USB_USX2Y SND_USB_CAIAQ SND_USB_CAIAQ_INPUT \
		SND_USB_US122L SND_USB_6FIRE SND_USB_HIFACE SND_BCD2000 SND_USB_LINE6 SND_USB_POD SND_USB_PODHD SND_USB_TONEPORT \
		SND_USB_VARIAX SND_FIREWIRE SND_FIREWIRE_LIB SND_DICE SND_OXFW SND_ISIGHT SND_FIREWORKS SND_BEBOB SND_FIREWIRE_DIGI00X \
		SND_FIREWIRE_TASCAM SND_FIREWIRE_MOTU SND_FIREFACE _SND_PCMCIA SND_VXPOCKET SND_PDAUDIOCF SND_SOC SND_SOC_AC97_BUS \
		SND_SOC_GENERIC_DMAENGINE_PCM SND_SOC_COMPRESS SND_SOC_TOPOLOGY SND_SOC_ACPI SND_SOC_AMD_ACP SND_SOC_AMD_CZ_DA7219MX98357_MACH \
		SND_SOC_AMD_CZ_RT5645_MACH SND_ATMEL_SOC SND_DESIGNWARE_I2S SND_DESIGNWARE_PCM

	# CODEC drivers
	mconfig SND_SOC_AC97_CODEC SND_SOC_ADAU_UTILS SND_SOC_ADAU1701 SND_SOC_ADAU17X1 SND_SOC_ADAU1761 SND_SOC_ADAU1761_I2C SND_SOC_ADAU1761_SPI \
		SND_SOC_ADAU7002 SND_SOC_AK4104 SND_SOC_AK4458 SND_SOC_AK4554 SND_SOC_AK4613 _SND_SOC_AK4642 SND_SOC_AK5386 SND_SOC_AK5558 SND_SOC_ALC5623 \
		SND_SOC_BD28623 SND_SOC_CPCAP SND_SOC_CS35L32 SND_SOC_CS35L33 SND_SOC_CS35L34 SND_SOC_CS35L35 SND_SOC_CS42L42 \
		SND_SOC_CS42L51 SND_SOC_CS42L51_I2C SND_SOC_CS42L52 SND_SOC_CS42L56 SND_SOC_CS42L73 SND_SOC_CS4265 SND_SOC_CS4270 \
		SND_SOC_CS4271 SND_SOC_CS4271_I2C SND_SOC_CS4271_SPI SND_SOC_CS42XX8 SND_SOC_CS42XX8_I2C SND_SOC_CS43130 SND_SOC_CS4349 \
		SND_SOC_CS53L30 SND_SOC_DA7213 SND_SOC_DA7219 SND_SOC_DIO2125 SND_SOC_DMIC SND_SOC_HDMI_CODEC SND_SOC_ES7134 SND_SOC_ES8316 \
		SND_SOC_ES8328 SND_SOC_ES8328_I2C SND_SOC_ES8328_SPI SND_SOC_GTM601 SND_SOC_HDAC_HDMI SND_SOC_INNO_RK3036 SND_SOC_MAX98090 \
		SND_SOC_MAX98357A SND_SOC_MAX98504 SND_SOC_MAX9867 SND_SOC_MAX98927 SND_SOC_MAX98373 SND_SOC_MAX9860 SND_SOC_MSM8916_WCD_ANALOG \
		SND_SOC_MSM8916_WCD_DIGITAL SND_SOC_PCM1681 SND_SOC_PCM1789 SND_SOC_PCM1789_I2C SND_SOC_PCM179X SND_SOC_PCM179X_I2C \
		SND_SOC_PCM179X_SPI SND_SOC_PCM186X SND_SOC_PCM186X_I2C SND_SOC_PCM186X_SPI SND_SOC_PCM3168A SND_SOC_PCM3168A_I2C \
		SND_SOC_PCM3168A_SPI SND_SOC_PCM512x SND_SOC_PCM512x_I2C SND_SOC_PCM512x_SPI SND_SOC_RL6231 SND_SOC_RL6347A \
		SND_SOC_RT286 SND_SOC_RT298 SND_SOC_RT5514 SND_SOC_RT5514_SPI SND_SOC_RT5616 SND_SOC_RT5631 SND_SOC_RT5640 \
		SND_SOC_RT5645 SND_SOC_RT5651 SND_SOC_RT5663 SND_SOC_RT5670 SND_SOC_RT5677 SND_SOC_RT5677_SPI SND_SOC_SGTL5000 \
		SND_SOC_SI476X SND_SOC_SIGMADSP SND_SOC_SIGMADSP_I2C SND_SOC_SIGMADSP_REGMAP SND_SOC_SIRF_AUDIO_CODEC SND_SOC_SPDIF \
		SND_SOC_SSM2602 SND_SOC_SSM2602_SPI SND_SOC_SSM2602_I2C SND_SOC_SSM4567 SND_SOC_STA32X SND_SOC_STA350 SND_SOC_STI_SAS \
		SND_SOC_TAS2552 SND_SOC_TAS5086 SND_SOC_TAS571X SND_SOC_TAS5720 SND_SOC_TAS6424 SND_SOC_TDA7419 SND_SOC_TFA9879 \
		SND_SOC_TLV320AIC23 SND_SOC_TLV320AIC23_I2C SND_SOC_TLV320AIC23_SPI SND_SOC_TLV320AIC31XX SND_SOC_TLV320AIC32X4 \
		SND_SOC_TLV320AIC32X4_I2C SND_SOC_TLV320AIC32X4_SPI SND_SOC_TLV320AIC3X SND_SOC_TS3A227E SND_SOC_TSCS42XX \
		SND_SOC_WM8510 SND_SOC_WM8523 SND_SOC_WM8524 SND_SOC_WM8580 SND_SOC_WM8711 SND_SOC_WM8728 SND_SOC_WM8731 \
		SND_SOC_WM8737 SND_SOC_WM8741 SND_SOC_WM8750 SND_SOC_WM8753 SND_SOC_WM8770 SND_SOC_WM8776 SND_SOC_WM8804 \
		SND_SOC_WM8804_I2C SND_SOC_WM8804_SPI SND_SOC_WM8903 SND_SOC_WM8960 SND_SOC_WM8962 SND_SOC_WM8974 \
		SND_SOC_WM8978 SND_SOC_WM8985 SND_SOC_ZX_AUD96P22 SND_SOC_MAX9759 SND_SOC_NAU8540 SND_SOC_NAU8810 \
		SND_SOC_NAU8824 SND_SOC_NAU8825 SND_SOC_TPA6130A2 SND_SIMPLE_CARD_UTILS SND_SIMPLE_CARD \
		SND_SIMPLE_SCU_CARD SND_AUDIO_GRAPH_CARD SND_AUDIO_GRAPH_SCU_CARD HDMI_LPE_AUDIO SND_SYNTH_EMUX AC97_BUS

	# HID drivers
	yconfig HID_A4TECH HID_ACCUTOUCH HID_ACRUX HID_ACRUX_FF HID_APPLE HID_APPLEIR HID_ASUS HID_AUREAL HID_BELKIN HID_BETOP_FF \
		HID_CHERRY HID_CHICONY HID_CORSAIR HID_PRODIKEYS HID_CMEDIA HID_CP2112 HID_CYPRESS HID_DRAGONRISE DRAGONRISE_FF \
		HID_EMS_FF HID_ELAN HID_ELECOM HID_ELO HID_EZKEY HID_GEMBIRD HID_GFRM HID_HOLTEK HOLTEK_FF HID_GOOGLE_HAMMER \
		HID_GT683R HID_KEYTOUCH HID_KYE HID_UCLOGIC HID_WALTOP HID_GYRATION HID_ICADE HID_IT HID_JABRA HID_TWINHAN HID_KENSINGTON \
		HID_LCPOWER HID_LED HID_LENOVO HID_LOGITECH HID_LOGITECH_DJ HID_LOGITECH_HIDPP LOGITECH_FF LOGIRUMBLEPAD2_FF LOGIG940_FF \
		LOGIWHEELS_FF HID_MAGICMOUSE HID_MAYFLASH HID_MICROSOFT HID_MONTEREY HID_MULTITOUCH HID_NTI HID_NTRIG HID_ORTEK HID_PANTHERLORD \
		PANTHERLORD_FF HID_PENMOUNT HID_PETALYNX HID_PICOLCD _HID_PICOLCD_FB HID_PICOLCD_BACKLIGHT HID_PICOLCD_LCD HID_PICOLCD_LEDS \
		HID_PICOLCD_CIR HID_PLANTRONICS HID_PRIMAX _HID_RETRODE HID_ROCCAT HID_SAITEK HID_SAMSUNG HID_SONY SONY_FF HID_SPEEDLINK \
		HID_STEELSERIES HID_SUNPLUS HID_RMI HID_GREENASIA GREENASIA_FF HID_HYPERV_MOUSE HID_SMARTJOYPLUS SMARTJOYPLUS_FF \
		HID_TIVO HID_TOPSEED HID_THINGM HID_THRUSTMASTER THRUSTMASTER_FF HID_UDRAW_PS3 HID_WACOM HID_WIIMOTE HID_XINMO \
		HID_ZEROPLUS ZEROPLUS_FF HID_ZYDACRON HID_SENSOR_HUB HID_ALPS INTEL_ISH_HID

	# USB storage drivers
	yconfig USB_STORAGE_REALTEK REALTEK_AUTOPM _USB_STORAGE_DATAFAB USB_STORAGE_FREECOM USB_STORAGE_ISD200 \
		USB_STORAGE_USBAT USB_STORAGE_SDDR09 USB_STORAGE_SDDR55 USB_STORAGE_JUMPSHOT USB_STORAGE_ALAUDA \
		USB_STORAGE_ONETOUCH USB_STORAGE_KARMA USB_STORAGE_CYPRESS_ATACB USB_STORAGE_ENE_UB6250 USB_UA

	# USB port drivers
	mconfig USB_USS720 USB_SERIAL USB_SERIAL_GENERIC USB_SERIAL_SIMPLE USB_SERIAL_AIRCABLE USB_SERIAL_ARK3116 USB_SERIAL_BELKIN \
		USB_SERIAL_CH341 USB_SERIAL_WHITEHEAT USB_SERIAL_DIGI_ACCELEPORT USB_SERIAL_CP210X USB_SERIAL_CYPRESS_M8 \
		USB_SERIAL_EMPEG USB_SERIAL_FTDI_SIO USB_SERIAL_VISOR USB_SERIAL_IPAQ USB_SERIAL_IR USB_SERIAL_EDGEPORT \
		USB_SERIAL_EDGEPORT_TI USB_SERIAL_F81232 USB_SERIAL_F8153X USB_SERIAL_GARMIN USB_SERIAL_IPW USB_SERIAL_IUU \
		USB_SERIAL_KEYSPAN_PDA USB_SERIAL_KEYSPAN USB_SERIAL_KLSI USB_SERIAL_KOBIL_SCT USB_SERIAL_MCT_U232 \
		USB_SERIAL_METRO USB_SERIAL_MOS7720 USB_SERIAL_MOS7715_PARPORT USB_SERIAL_MOS7840 USB_SERIAL_MXUPORT \
		USB_SERIAL_NAVMAN USB_SERIAL_PL2303 USB_SERIAL_OTI6858 USB_SERIAL_QCAUX USB_SERIAL_QUALCOMM \
		USB_SERIAL_SPCP8X5 USB_SERIAL_SAFE USB_SERIAL_SIERRAWIRELESS USB_SERIAL_SYMBO USB_SERIAL_TI \
		USB_SERIAL_CYBERJACK USB_SERIAL_XIRCOM USB_SERIAL_WWAN USB_SERIAL_OPTION USB_SERIAL_OMNINET \
		USB_SERIAL_OPTICON USB_SERIAL_XSENS_MT USB_SERIAL_WISHBONE USB_SERIAL_SSU100 USB_SERIAL_QT2 \
		USB_SERIAL_UPD78F0730 USB_SERIAL_DEBUG

	# USB misc
	mconfig USB_EMI62 USB_EMI26 USB_ADUTUX USB_SEVSEG USB_RIO500 _USB_LEGOTOWER USB_LCD USB_CYPRESS_CY7C63 USB_CYTHERM USB_IDMOUSE \
		USB_FTDI_ELAN USB_APPLEDISPLAY USB_SISUSBVGA USB_SISUSBVGA_CON USB_LD USB_TRANCEVIBRATOR USB_IOWARRIOR USB_TEST \
		USB_EHSET_TEST_FIXTURE USB_ISIGHTFW USB_YUREX USB_EZUSB_FX2 USB_HUB_USB251XB USB_HSIC_USB3503 USB_HSIC_USB4604 \
		USB_LINK_LAYER_TEST USB_CHAOSKEY USB_ATM USB_SPEEDTOUCH USB_CXACRU USB_UEAGLEATM USB_XUSBATM

	# Framebuffer
	mconfig BACKLIGHT_LCD_SUPPORT LCD_CLASS_DEVIC LCD_L4F00242T03 LCD_LMS283GF05 LCD_LTV350QV \
		LCD_ILI922X LCD_ILI9320 LCD_TDO24M LCD_VGG2432A4 LCD_PLATFORM LCD_S6E63M0 LCD_LD9040 LCD_AMS369FG06 \
		LCD_LMS501KF03 LCD_HX8357 BACKLIGHT_CLASS_DEVICE BACKLIGHT_GENERIC BACKLIGHT_LM3533 BACKLIGHT_PWM \
		BACKLIGHT_DA903X BACKLIGHT_DA9052 BACKLIGHT_MAX8925 BACKLIGHT_APPLE BACKLIGHT_PM8941_WLED BACKLIGHT_SAHARA \
		BACKLIGHT_WM831X BACKLIGHT_ADP5520 BACKLIGHT_ADP8860 BACKLIGHT_ADP8870 BACKLIGHT_88PM860X BACKLIGHT_PCF50633 \
		BACKLIGHT_AAT2870 BACKLIGHT_LM3630A BACKLIGHT_LM3639 BACKLIGHT_LP855X BACKLIGHT_LP8788 BACKLIGHT_PANDORA \
		BACKLIGHT_SKY81452 BACKLIGHT_TPS65217 BACKLIGHT_AS3711 BACKLIGHT_GPIO BACKLIGHT_LV5207LP BACKLIGHT_BD6107 \
		BACKLIGHT_ARCXCNN VIDEOMODE_HELPERS HDMI

	# Network drivers
	mconfig VORTEX PCNET32 ATL2 ATL1 ATL1E ATL1C ALX B44 B44_PCI_AUTOSELECT B44_PCICORE_AUTOSELECT \
		B44_PCI BNX2 CNIC TIGON3 DNET ULI526X E100 E1000 E1000E E1000E_HWTS IGB IGB_HWMON IXGB IXGBE \
		IXGBE_HWMON IXGBEVF JME SKGE SKGE_GENESIS SKY2 FORCEDETH QLA3XXX 8139TOO R8169 SIS900 SIS190 SMSC911X SMSC9420 VIA_RHINE VIA_VELOCITY \
		AT803X_PHY AMD_PHY MARVELL_PHY SMSC_PHY BCM_NET_PHYLIB BROADCOM_PHY BCM87XX_PHY REALTEK_PHY FIXED_PHY VITESSE_PHY USB_NET_DRIVERS \
		USB_RTL8152 USB_USBNET USB_NET_AX8817X USB_NET_AX88179_178A USB_NET_CDCETHER USB_NET_DM9601 USB_NET_SMSC75XX \
		USB_NET_SMSC95XX USB_NET_MCS7830 USB_NET_RNDIS_HOST USB_IPHETH IBMVETH NE2K_PCI

	# PHY
	mconfig AT803X_PHY AMD_PHY MARVELL_PHY SMSC_PHY BCM_NET_PHYLIB \
		BROADCOM_PHY BCM87XX_PHY REALTEK_PHY FIXED_PHY VITESSE_PHY

	# Wireless drivers
	mconfig ATMEL PCI_ATMEL IWLEGACY IWL4965 IWL3945 IWLWIFI IWLWIFI_LEDS IWLDVM IWLMVM IWLWIFI_OPMODE_MODULAR IWLWIFI_PCIE_RTPM \
		P54_COMMON P54_PCI P54_LEDS LIBERTAS MWIFIEX MWIFIEX_PCIE MWL8K RT2X00 RT2400PCI RT2500PCI RT61PCI RT2800PCI \
		RT2800PCI_RT33XX RT2800PCI_RT35XX RT2800PCI_RT53XX RT2800PCI_RT3290 RT2800_LIB RT2800_LIB_MMIO \
		RT2X00_LIB_MMIO RT2X00_LIB_PCI RT2X00_LIB RT2X00_LIB_FIRMWARE RT2X00_LIB_CRYPTO RT2X00_LIB_LEDS \
		RTL8180 RTL_CARDS RTL8192CE RTL8192SE RTL8192DE RTL8723AE RTL8723BE RTL8188EE RTL8192EE \
		RTL8821AE RTLWIFI RTLWIFI_PCI RTL8192C_COMMON RTL8723_COMMON RTLBTCOEXIST RTLLIB \
		RTLLIB_CRYPTO_CCMP RTLLIB_CRYPTO_TKIP RTLLIB_CRYPTO_WEP RTL8192E CARL9170 CARL9170_LEDS CARL9170_WPC CARL9170_HWRNG \
		P54_USB P54_LEDS LIBERTAS LIBERTAS_USB LIBERTAS_THINFIRM LIBERTAS_THINFIRM_USB MWIFIEX MWIFIEX_USB \
		MT7601U RT2X00 RT2500USB RT73USB RT2800USB RT2800USB_RT33XX RT2800USB_RT35XX RT2800USB_RT3573 \
		RT2800USB_RT53XX RT2800USB_RT55XX RT2800USB_UNKNOWN RT2800_LIB RT2X00_LIB_USB RT2X00_LIB \
		RT2X00_LIB_FIRMWARE RT2X00_LIB_CRYPTO RT2X00_LIB_LEDS RTL8187 RTL8187_LEDS RTL_CARDS \
		RTL8XXXU RTL8XXXU_UNTESTED RTL8192CU RTLWIFI RTLWIFI_USB RTL8192C_COMMON \
		USB_ZD1201 ZD1211RW RTL8192U RTLLIB RTLLIB_CRYPTO_CCMP RTLLIB_CRYPTO_TKIP \
		RTLLIB_CRYPTO_WEP R8712U R8188EU 88EU_AP_MODE VT6656 ATH_COMMON ATH5K ATH5K_DEBUG ATH5K_TRACER ATH5K_PCI ATH9K_HW ATH9K_COMMON ATH9K_COMMON_DEBUG \
		ATH9K_BTCOEX_SUPPORT ATH9K ATH9K_PCI ATH9K_AHB ATH9K_DEBUGFS ATH9K_STATION_STATISTICS \
		ATH9K_DYNACK ATH9K_WOW ATH9K_RFKILL ATH9K_CHANNEL_CONTEX ATH9K_PCOEM ATH9K_HTC \
		ATH9K_HTC_DEBUGFS ATH9K_HWRNG ATH9K_COMMON_SPECTRAL ATH6KL ATH6KL_SDIO ATH6KL_USB \
		ATH6KL_DEBUG  ATH6KL_TRACING ATH10K ATH10K_CE ATH10K_PCI ATH10K_AHB \
		ATH10K_SDIO ATH10K_USB ATH10K_DEBUG ATH10K_DEBUGFS ATH10K_SPECTRAL ATH10K_TRACING WCN36XX \
		B43 B43_BCMA B43_SSB B43_BUSES_BCMA_AND_SSB B43_PCI_AUTOSELECT \
		B43_PCICORE_AUTOSELECT B43_SDIO B43_BCMA_PIO B43_PIO \
		B43_PHY_G B43_PHY_N B43_PHY_LP B43_PHY_HT B43_LEDS B43_HWRNG \
		B43LEGACY B43LEGACY_PCI_AUTOSELECT B43LEGACY_PCICORE_AUTOSELECT \
		B43LEGACY_LEDS B43LEGACY_HWRNG B43LEGACY_DEBUG B43LEGACY_DMA \
		B43LEGACY_PIO B43LEGACY_DMA_AND_PIO_MODE BRCMUTIL BRCMSMAC \
		BRCMFMAC BRCMFMAC_PROTO_BCDC BRCMFMAC_PROTO_MSGBUF BRCMFMAC_SDIO \
		BRCMFMAC_USB BRCMFMAC_PCIE BRCM_TRACING BRCMDBG IBMVETH NE2K_PCI PCNET32 \
		MACSONIC E1000 8139CP

	# Host AP
	mconfig HOSTAP HOSTAP_FIRMWARE HOSTAP_FIRMWARE_NVRAM HOSTAP_PLX HOSTAP_PCI HOSTAP_CS

	# Framebuffer drivers
	mconfig FIRMWARE_EDID FB_CMDLINE FB_NOTIFY FB_BOOT_VESA_SUPPORT FB_CFB_FILLRECT FB_CFB_COPYAREA \
		FB_CFB_IMAGEBLIT FB_SYS_FILLRECT FB_SYS_COPYAREA FB_SYS_IMAGEBLIT FB_SYS_FOPS FB_DEFERRED_IO FB_BACKLIGHT FB_MODE_HELPERS FB_TILEBLITTING

	# Display panel drivers
	mconfig DRM_PANEL_ARM_VERSATILE DRM_PANEL_LVDS DRM_PANEL_SIMPLE DRM_PANEL_ILITEK_IL9322 DRM_PANEL_INNOLUX_P079ZCA \
		DRM_PANEL_JDI_LT070ME05000 DRM_PANEL_SAMSUNG_LD9040 DRM_PANEL_LG_LG4573 DRM_PANEL_ORISETECH_OTM8009A \
		DRM_PANEL_PANASONIC_VVX10F034N00 DRM_PANEL_RASPBERRYPI_TOUCHSCREEN DRM_PANEL_RAYDIUM_RM68200 \
		DRM_PANEL_SAMSUNG_S6E3HA2 DRM_PANEL_SAMSUNG_S6E63J0X03 DRM_PANEL_SAMSUNG_S6E8AA0 DRM_PANEL_SEIKO_43WVF1G \
		DRM_PANEL_SHARP_LQ101R1SX01 DRM_PANEL_SHARP_LS043T1LE01 DRM_PANEL_SITRONIX_ST7789V DRM_BRIDGE DRM_PANEL_BRIDGE

	# Webcam drivers
	mconfig USB_VIDEO_CLASS USB_VIDEO_CLASS_INPUT_EVDEV USB_GSPCA USB_M5602 USB_STV06XX USB_GL860 \
		USB_GSPCA_BENQ USB_GSPCA_CONEX USB_GSPCA_CPIA1 USB_GSPCA_DTCS033 USB_GSPCA_ETOMS USB_GSPCA_FINEPIX \
		USB_GSPCA_JEILINJ USB_GSPCA_JL2005BCD USB_GSPCA_KINECT USB_GSPCA_KONICA USB_GSPCA_MARS USB_GSPCA_MR97310A \
		USB_GSPCA_NW80X USB_GSPCA_OV519 USB_GSPCA_OV534 USB_GSPCA_OV534_9 USB_GSPCA_PAC207 USB_GSPCA_PAC7302 \
		USB_GSPCA_PAC7311 USB_GSPCA_SE401 USB_GSPCA_SN9C2028 USB_GSPCA_SN9C20X USB_GSPCA_SONIXB USB_GSPCA_SONIXJ \
		USB_GSPCA_SPCA500 USB_GSPCA_SPCA501 USB_GSPCA_SPCA505 USB_GSPCA_SPCA506 USB_GSPCA_SPCA508 USB_GSPCA_SPCA561 \
		USB_GSPCA_SPCA1528 USB_GSPCA_SQ905 USB_GSPCA_SQ905C USB_GSPCA_SQ930X USB_GSPCA_STK014 USB_GSPCA_STK1135 \
		USB_GSPCA_STV0680 USB_GSPCA_SUNPLUS USB_GSPCA_T613 USB_GSPCA_TOPRO USB_GSPCA_TOUPTEK USB_GSPCA_TV8532 \
		USB_GSPCA_VC032X USB_GSPCA_VICAM USB_GSPCA_XIRLINK_CIT USB_GSPCA_ZC3XX USB_PWC USB_PWC_INPUT_EVDEV \
		VIDEO_CPIA2 USB_ZR364XX USB_STKWEBCAM USB_S2255 VIDEO_USBTV

	# chargers
	yconfig W1 POWER_AVS POWER_RESET PDA_POWER
	mconfig CHARGER_ADP5061 BATTERY_DS2780 BATTERY_DS2781 BATTERY_DS2782 \
		BATTERY_SBS CHARGER_SBS BATTERY_BQ27XXX BATTERY_MAX17040 BATTERY_MAX17042 \
		CHARGER_MAX8903 CHARGER_LP8727 CHARGER_GPIO CHARGER_MANAGER CHARGER_LTC365 \
		CHARGER_BQ2415X CHARGER_BQ24257 CHARGER_BQ24735 CHARGER_BQ25890 CHARGER_SMB347 BATTERY_GAUGE_LTC2941 CHARGER_RT9455

	# PCMCIA
	yconfig PCMCIA PCMCIA_LOAD_CIS YENTA CARDBUS PD6729 PCMCIA_IOCTL
	nconfig PCMCIA_DEBUG

	# Sensors
	mconfig SENSORS_ATK0110 SENSORS_ABITUGURU SENSORS_ABITUGURU3 SENSORS_AD7414 SENSORS_AD7418 \
		SENSORS_ADM1021 SENSORS_ADM1025 SENSORS_ADM1026 SENSORS_ADM1029 SENSORS_ADM1031 \
		SENSORS_ADM9240 SENSORS_ADS7828 SENSORS_ADT7462 SENSORS_ADT7470 SENSORS_ADT7473 \
		SENSORS_ADT7475 SENSORS_APPLESMC SENSORS_ASB100 SENSORS_ATXP1 SENSORS_CORETEMP \
		SENSORS_DME1737 SENSORS_DS1621 SENSORS_DS1337 SENSORS_DS1374 SENSORS_FSCHER \
		SENSORS_FSCPOS SENSORS_F71805F SENSORS_F71882FG SENSORS_F75375S SENSORS_FSCHMD \
		SENSORS_G760A SENSORS_GL518SM SENSORS_GL520SM SENSORS_HDAPS SENSORS_IBMAEM SENSORS_IBMPEX \
		SENSORS_IT87 SENSORS_K8TEMP SENSORS_LIS3LV02D SENSORS_LM63 SENSORS_LM75 SENSORS_LM77 \
		SENSORS_LM78 SENSORS_LM80 SENSORS_LM83 SENSORS_LM85 SENSORS_LM87 SENSORS_LM90 \
		SENSORS_LM92 SENSORS_LM93 SENSORS_LTC4245 SENSORS_MAX1619 SENSORS_MAX6650 \
		SENSORS_MAX6875 SENSORS_PC87360 SENSORS_PC87427 SENSORS_PCA9539 SENSORS_PCF8574 \
		SENSORS_PCF8591 SENSORS_SHT15 SENSORS_SIS5595 SENSORS_SMSC47M1 SENSORS_SMSC47M192 \
		SENSORS_SMSC47B397 SENSORS_THMC50 SENSORS_TMP401 SENSORS_TSL2550 \
		SENSORS_VIA686A SENSORS_VIA_CPUTEMP SENSORS_VT1211 SENSORS_VT8231 SENSORS_W83627HF \
		SENSORS_W83781D SENSORS_W83L785TS SENSORS_W83L786NG SENSORS_W83627EHF SENSORS_W83791D \
		SENSORS_W83792D SENSORS_W83793 SENSORS_LTC4215 SENSORS_LM95241 SENSORS_TMP421 SENSORS_WM8350 SENSORS_WM831X
	nconfig SENSORS_I5K_AMBDS1682

	# misc
	yconfig IP_ROUTE_MULTIPATH IP_MULTIPLE_TABLES BRIDGE_IGMP_SNOOPING BPF_JIT \
		NETWORK_PHY_TIMESTAMPING BOOT_PRINTK_DELAY TRANSPARENT_HUGEPAGE \
		TRANSPARENT_HUGEPAGE_ALWAYS BPF_SYSCALL BPF_EVENTS DEBUG_INFO FUNCTION_TRACER KALLSYMS_ALL
	mconfig NET_CLS_BPF NET_ACT_BPF IP_VS BONDING BRIDGE NET_SCHED IFB NET_SCH_HTB \
		NET_SCH_CBQ NET_SCH_HFSC NET_SCH_FQ NET_SCH_FQ_CODEL NET_SCH_SFB NET_SCH_INGRESS \
		NET_CLS_U32 NET_SCH_CAKE NET_ACT_MIRRED NET_SCH_PIE TCP_CONG_BBR TUN

	strconfig DEFAULT_HOSTNAME yui
	strconfig UEVENT_HELPER_PATH ""
	strconfig NLS_DEFAULT "utf8"
	strconfig FAT_DEFAULT_IOCHARSET "ascii"
	strconfig DEFAULT_TCP_CONG "cubic"
	strconfig MAC80211_RC_DEFAULT "minstrel_ht"
	strconfig DEFAULT_SECURITY "tomoyo"
	strconfig EXTRA_FIRMWARE_DIR "/lib/firmware"
	strconfig NFS_V4_1_IMPLEMENTATION_ID_DOMAIN "kernel.org"
	varconfig MAC80211_STA_HASH_MAX_SIZE 0
	varconfig FAT_DEFAULT_CODEPAGE 437
	varconfig HZ 300
	varconfig BLK_DEV_LOOP_MIN_COUNT 0
	varconfig SND_HDA_PREALLOC_SIZE 2048
	varconfig USB_GADGET_VBUS_DRAW 2
	varconfig USB_GADGET_STORAGE_NUM_BUFFERS 2
	varconfig MMC_BLOCK_MINORS 32
	varconfig MMC_BCM2835_PIO_DMA_BARRIER 2
	varconfig DM9000_DEBUGLEVEL 4
	varconfig DE2104X_DSL 0
	varconfig USB_GADGET_VBUS_DRAW 2
	varconfig USB_GADGET_STORAGE_NUM_BUFFERS 2

	# fixes
	yconfig IP_MROUTE NF_NAT_MASQUERADE_IPV4 NET_SCHED E1000E_HWTS ATH5K_PCI DRM_FBDEV_EMULATION \
		DRM_I915_ALPHA_SUPPORT DRM_I915_CAPTURE_ERROR DRM_I915_COMPRESS_ERROR DRM_I915_USERPTR \
		DRM_I915_GVT DRM_BRIDGE DRM_PANEL_BRIDGE FIRMWARE_EDID FB_CMDLINE FB_NOTIFY \
		FB_DEFERRED_IO FB_MODE_HELPERS FB_TILEBLITTING BACKLIGHT_LCD_SUPPORT HDMI SND_PCI \
		SND_HDA_HWDEP SND_HDA_RECONFIG SND_HDA_INPUT_BEEP SND_HDA_PATCH_LOADER SND_HDA_I915 SND_USB \
		L2TP_V3 DRM_AMDGPU_SI DRM_AMDGPU_CIK DRM_NOUVEAU_BACKLIGHT DRM_VMWGFX_FBCON DRM_GMA600 \
		DRM_GMA3600 NF_NAT_MASQUERADE_IPV6 BT_BREDR BT_RFCOMM_TTY TOUCHSCREEN_ATMEL_MXT_T37 \
		TOUCHSCREEN_WM9705 TOUCHSCREEN_WM9712 TOUCHSCREEN_WM9713 TOUCHSCREEN_USB_EGALAX \
		TOUCHSCREEN_USB_PANJIT TOUCHSCREEN_USB_3M TOUCHSCREEN_USB_ITM TOUCHSCREEN_USB_ETURBO \
		TOUCHSCREEN_USB_GUNZE TOUCHSCREEN_USB_DMC_TSC10 TOUCHSCREEN_USB_IRTOUCH TOUCHSCREEN_USB_IDEALTEK \
		TOUCHSCREEN_USB_GENERAL_TOUCH TOUCHSCREEN_USB_GOTOP TOUCHSCREEN_USB_JASTEC TOUCHSCREEN_USB_ELO \
		TOUCHSCREEN_USB_E2I TOUCHSCREEN_USB_ZYTRONIC TOUCHSCREEN_USB_ETT_TC45USB TOUCHSCREEN_USB_NEXIO \
		TOUCHSCREEN_USB_EASYTOUCH TOUCHSCREEN_TSC2007_IIO JOYSTICK_IFORCE_USB JOYSTICK_IFORCE_232 \
		JOYSTICK_XPAD_FF JOYSTICK_XPAD_LEDS JOYSTICK_PSXPAD_SPI_FF SND_AC97_POWER_SAVE \
		SND_CS46XX_NEW_DSP SND_ES1968_INPUT SND_ES1968_RADIO SND_FM801_TEA575X_BOOL \
		SND_MAESTRO3_INPUT SND_HDA_CODEC_CA0132_DSP SND_HDA_DSP_LOADER SND_SPI \
		SND_USB_CAIAQ_INPUT SND_FIREWIRE SND_SOC_AC97_BUS SND_SOC_GENERIC_DMAENGINE_PCM \
		SND_SOC_COMPRESS SND_SOC_TOPOLOGY SND_DESIGNWARE_PCM USB_SERIAL_GENERIC USB_SERIAL_MOS7715_PARPORT \
		USB_SISUSBVGA_CON VIDEOMODE_HELPERS B44_PCI_AUTOSELECT B44_PCICORE_AUTOSELECT B44_PCI IGB_HWMON \
		IXGBE_HWMON SKGE_GENESIS IWLWIFI_LEDS IWLWIFI_OPMODE_MODULAR IWLWIFI_PCIE_RTPM P54_LEDS \
		RT2800PCI_RT33XX RT2800PCI_RT35XX RT2800PCI_RT53XX RT2800PCI_RT3290 RT2X00_LIB_FIRMWARE \
		RT2X00_LIB_CRYPTO RT2X00_LIB_LEDS CARL9170_LEDS CARL9170_WPC CARL9170_HWRNG \
		RT2800USB_RT33XX RT2800USB_RT35XX RT2800USB_RT3573 RT2800USB_RT53XX RT2800USB_RT55XX \
		RT2800USB_UNKNOWN RTL8187_LEDS RTL8XXXU_UNTESTED 88EU_AP_MODE ATH5K_DEBUG ATH5K_TRACER \
		ATH9K_COMMON_DEBUG ATH9K_BTCOEX_SUPPORT ATH9K_PCI ATH9K_AHB ATH9K_DEBUGFS \
		ATH9K_STATION_STATISTICS ATH9K_DYNACK ATH9K_WOW ATH9K_RFKILL ATH9K_PCOEM \
		ATH9K_HTC_DEBUGFS ATH9K_HWRNG ATH9K_COMMON_SPECTRAL ATH6KL_DEBUG ATH6KL_TRACING \
		ATH10K_CE ATH10K_AHB ATH10K_DEBUGFS ATH10K_SPECTRAL ATH10K_TRACING B43_BCMA \
		B43_SSB B43_BUSES_BCMA_AND_SSB B43_PCI_AUTOSELECT B43_PCICORE_AUTOSELECT \
		B43_SDIO B43_BCMA_PIO B43_PIO B43_PHY_G B43_PHY_N B43_PHY_LP B43_PHY_HT \
		B43_LEDS B43_HWRNG B43LEGACY_PCI_AUTOSELECT B43LEGACY_PCICORE_AUTOSELECT \
		B43LEGACY_LEDS B43LEGACY_HWRNG B43LEGACY_DEBUG B43LEGACY_DMA B43LEGACY_PIO \
		B43LEGACY_DMA_AND_PIO_MODE BRCMFMAC_PROTO_BCDC BRCMFMAC_PROTO_MSGBUF \
		BRCMFMAC_SDIO BRCMFMAC_USB BRCMFMAC_PCIE BRCM_TRACING BRCMDBG HOSTAP_FIRMWARE \
		HOSTAP_FIRMWARE_NVRAM FB_BOOT_VESA_SUPPORT FB_BACKLIGHT USB_VIDEO_CLASS_INPUT_EVDEV USB_PWC_INPUT_EVDEV
	nconfig ATH10K_DEBUG

	if [ "$CROSS" = "yes" ]; then
		yes '' | make ARCH=$XKARCH CROSS_COMPILE=${CROSS_COMPILE} olddefconfig
	else
		yes '' | make ARCH=$XKARCH olddefconfig
	fi

	sed -i "s/.*DEBUG_INFO.*/\\# DEBUG_INFO is not set/" .config
}

build() {
	case $BARCH in
		x86_64)
			export XKARCH="x86_64"
			export IMAGELOC="arch/x86/boot/bzImage"
			;;
		i586)
			export XKARCH="i386"
			export IMAGELOC="arch/x86/boot/bzImage"
			;;
		ppc64le|ppc64|ppc)
			export XKARCH="powerpc"
			export IMAGELOC="vmlinux"
			;;
		riscv64|riscv32)
			export XKARCH="riscv"
			export IMAGELOC="vmlinux"
			;;
		*)
			echo "Architecture is not set or is not supported by Ataraxia Linux"
			exit 1
	esac

	cd "$SRC"/$name-$version
	gzip -dc "$SRC"/reiser4-for-$reiserfs4patchver.patch.gz | patch -p1
	patch -Np1 -i "$STUFF"/linux/wireguard.patch

	unset LDFLAGS
	make mrproper


	if [ "$CROSS" != "yes" ]; then
		if [ -f /boot/config-linux ]; then
			cp /boot/config-linux .config
		else
			generate_config
		fi
	else
		generate_config
	fi

	if [ "$CROSS" = "yes" ]; then
		make ARCH=$XKARCH CROSS_COMPILE=${CROSS_COMPILE}
	else
		make ARCH=$XKARCH
	fi

	if [ "$CROSS" = "yes" ]; then
		make ARCH=$XKARCH CROSS_COMPILE=${CROSS_COMPILE} INSTALL_MOD_STRIP=1 INSTALL_MOD_PATH="$PKG"/usr modules_install
	else
		make ARCH=$XKARCH INSTALL_MOD_STRIP=1 INSTALL_MOD_PATH="$PKG"/usr modules_install
	fi

	mkdir -p "$PKG"/boot
	cp "$IMAGELOC" "$PKG"/boot/vmlinuz-linux
	cp .config "$PKG"/boot/config-linux

	rm -rf "$PKG"/lib/modules/*/{build,source}
}
